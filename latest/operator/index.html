<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Operator - Formula Student Driverless Simulator</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../css/version-select.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Operator";
    var mkdocs_page_input_path = "operator.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Formula Student Driverless Simulator</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Introduction</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../system-overview/">System overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting started</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../getting-started-with-ros/">Getting started with ROS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../getting-started-with-python/">Getting started with Python</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Vehicle & Sensors</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../vehicle_model/">Vehicle model</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../imu/">IMU</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../lidar/">Lidar</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../camera/">Camera</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../gps/">GPS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ground-speed-sensor/">GSS</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">#tech-madness</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../ros-bridge/">ROS Bridge</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../statistics/">ROS Bridge statistics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../joystick/">Joystick</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../coordinate-frames/">Coordinate frames</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../import-car-3d-model/">Import your 3d car model</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../gcp-remote-workstation/">Google cloud remote workstation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../software-install-instructions/">Software install instructions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../how-to-release/">How to release</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Competition tooling</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Operator</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#team-config">Team config</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#logs">Logs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#passwords-security">Passwords &amp; Security</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-the-operator">Running the operator</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-the-bridge-launcher">Running the bridge launcher</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../competition-signals/">System flow and signals</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../spectator/">Spectator</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Formula Student Driverless Simulator</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Competition tooling &raquo;</li>
        
      
    
    <li>Operator</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/FS-Driverless/Formula-Student-Driverless-Simulator/edit/master/docs/operator.md"> Edit on FS-Driverless/Formula-Student-Driverless-Simulator</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="operator">Operator</h1>
<p>The operator offers competition officials a way to control and keep track of what is happening in the simulation
It consists of a webserver with web interface where the official can select a team, missions and track and then launch the simulator.
DOO cones and lap times will be shown and stored on disk. 
The bridge launcher is a helper script to launch the ros bridge on a different computer.
It launches the ros bridge with configuration set in the web interface.</p>
<p><strong>The operator is primarily used during competition by officials. You don't need this for development and testing.</strong>
Refer to the <a href="../getting-started/">getting started guide</a> first.</p>
<p><img alt="Operator" src="../images/operator.jpg" /></p>
<h2 id="team-config">Team config</h2>
<p>The operator uses the <code>team_config.json</code> file located in the <code>/config</code> folder to load all team specific configuration settings into the simulator. 
This includes the name of each team and their car settings. 
Whenever the simulation is started via the operator's web interface, the selected team's car settings are written to the <code>settings.json</code> file located in the main folder of the repository. 
This allows the operator to quickly switch between teams during competition.
Note that the <code>team_config.json</code> file included in this repository is an example file.</p>
<h2 id="logs">Logs</h2>
<p>Whenever a mission starts, a log file is created in the <code>/operator/logs</code> folder.
All logs received by the webserver will be written to this log file, as long as the mission is ongoing.
Log files are named using the following naming convention: <code>{datetime}_{team}_{mission}.txt</code></p>
<h2 id="passwords-security">Passwords &amp; Security</h2>
<p>To ensure only authorized personal can controll the simulation a password is required for all actions.
This password is configured inside the <code>operator.py</code> file in variable <code>access_token</code>.
Yes, this is a hard-coded value because I couldn't be bothered doing configuration files for something that changes almost never.
Please change the default value <code>1234567890</code> it before running a real competition.</p>
<p>The spectator server should also be protected with a password as described in <a href="../spectator/">the spectator documentation</a>.
The operator writes the spectator password to the settings.json file when the simulation starts so it is not needed to configure the <code>SpectatorPassword</code> inside the <code>team_config.json</code>. 
Again, this is a hard-coded value in the <code>operator.py</code>, default set to <code>password</code>.
Please change before competition.</p>
<h2 id="running-the-operator">Running the operator</h2>
<p>The operator is built to work on Windows because most likely, the simulation will also run on windows.</p>
<p>To install all python dependencies, run the following command inside the <code>/operator</code> folder:</p>
<pre><code class="bash">$ pip install -r requirements.txt
</code></pre>

<p>Next, download a packaged version of the simulator
Go to the <a href="https://github.com/FS-Driverless/Formula-Student-Driverless-Simulator/releases">releases</a> and download the latest version.
Extract the zip to the <code>simulator</code> folder at the root of this project.
The result should be that the following files and folders exist inside the <code>simulator</code> folder:</p>
<ul>
<li>FSDS.exe</li>
<li>FSOnline/</li>
<li>Engine/</li>
</ul>
<p><a href="../how-to-release/">Here</a> is described how to export the Unreal project.</p>
<p>To start the web server, run the following command in the <code>operator</code> folder:</p>
<pre><code class="bash">$ python operator.py
</code></pre>

<p>By default, the web interface binds to all ip's of the machine on port 5000.</p>
<h2 id="running-the-bridge-launcher">Running the bridge launcher</h2>
<p>The ros bridge will most likely not run on the same computer as the simulator as the ros bridge works best on Ubuntu and the simulator best on Windows.
It is discouraged to run the ros bridge on WSL during competition, see <a href="https://github.com/FS-Driverless/Formula-Student-Driverless-Simulator/issues/199">#199</a>.</p>
<p>To help you quickly start the ros bridge with the configuration parameters set in the operator you can use the bridge launcher.
This script will request the configuration from the operator using an http api call and launch the bridge accordingly.</p>
<p>Before you run it, change the following variables inside the <code>launchbridge.py</code> script to reflect your setup:</p>
<pre><code>operator_url = &quot;http://10.164.0.3:5000&quot;
operator_token = &quot;1234567890&quot;
</code></pre>

<p>Next, run the script as follows:</p>
<pre><code>eval `./launchbridge.py`
</code></pre>

<p><strong>Why eval?</strong> Because I think it is a bad idea to have the ros bridge run as a sub-process of the bridge launcher.
We don't want a problem in the bridge launcher to stop the bridge.
We don't want deal with forwarding logs and signals.
<code>./launchbridge.py</code> executes as a whole, outputting bash commands to stdout.
All stdout is interperted as bash commands and executed by eval. 
The rosbridge process is ran <em>after</em> the launchbridge finishes, which is kind-of neat.
I know that this is by no way a perfect solution.
So if you think you can do better I invite you to propose your solution in a github ticket and open a pr.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../competition-signals/" class="btn btn-neutral float-right" title="System flow and signals">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../how-to-release/" class="btn btn-neutral" title="How to release"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>GPLv2</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../how-to-release/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../competition-signals/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../js/version-select.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
